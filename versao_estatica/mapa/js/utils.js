var zoomHome=L.Control.zoomHome({zoomHomeTitle:"Zoom Inicial",position:"topright"}),fullScreen=L.control.fullscreen({position:"topright",title:"Mapa em tela cheia",titleCancel:"Sair da tela cheia",fullscreenControl:!0}),geocodingSearch=L.control.maptilerGeocoding({apiKey:"todhtNTYQmjE6y5MNZ9k",placeholder:"Pesquisar por localização...",collapse:!1,language:"pt",country:"br",noResultsMessage:'"Ops! Não conseguimos encontrar o que você está procurando. Tente verificar a ortografia ou um outro termo de pesquisa.'}),coordinates=L.control.coordinates({enableUserInput:!1,useDMS:!0,position:"bottomleft",decimals:5,decimalSeperator:",",labelTemplateLng:"Long: {x}",labelTemplateLat:"Lat: {y}"}),limitsBr=L.geoJson(limiteBr,{style:{color:"#000",weight:1.7,opacity:.8}}),acoesUrl=$("#acoes_geojson").val(),categoryMappings={"Acesso à Justiça e Combate às Desigualdades":{iconClass:"fa-scale-balanced",markerColor:"cadetblue"},"Planejamento Urbano, Gestão de Riscos e Responsabilidade Climática":{iconClass:"fa-cloud-sun-rain",markerColor:"blue"},"Comunicação, Inclusão Digital e Educação Popular":{iconClass:"fa-graduation-cap",markerColor:"orange"},"Cultura e Memória":{iconClass:"fa-masks-theater",markerColor:"pink"},"Saúde Integral e Dignidade Humana":{iconClass:"fa-briefcase-medical",markerColor:"red"},"Soberania Alimentar e Nutricional":{iconClass:"fa-utensils",markerColor:"black"},"Economia Solidária":{iconClass:"fa-sack-dollar",markerColor:"darkgreen"}};function createMarker(r,e,o,s){return L.marker(r,{icon:L.AwesomeMarkers.icon({prefix:"fa",icon:e,markerColor:o})}).bindPopup(s)}function pointToLayer(r,e){var o=r.properties.categoria,s=`<span>Organização:</span>${r.properties.organizacao}\n                        <span>Categoria:</span>${r.properties.categoria}\n                        <span>Localidade:</span>${r.properties.localidade}\n                        <span>Premiado:</span>${r.properties.premiado?"Sim":"Não"}\n                        <span>Município/Estado:</span>${r.properties.municipio}/${r.properties.estado}\n                       `,{iconClass:a,markerColor:t}=categoryMappings[o]||{iconClass:"fa-question",markerColor:"gray"};return createMarker(e,a,t,s)}const clustersAndProperties=[],clustersPremiumAndProperties=[];Object.entries(categoryMappings).forEach((([r,e],o)=>{const s=new L.GeoJSON.AJAX(acoesUrl,{filter:function(e,o){return e.properties.categoria===r},pointToLayer:pointToLayer}),a=new L.markerClusterGroup;s.on("data:loaded",(function(){a.addLayer(s),map.spin(!1)})),clustersAndProperties.push({category:r,clusterLayer:a,properties:e})})),Object.entries(categoryMappings).forEach((([r,e],o)=>{const s=new L.GeoJSON.AJAX(acoesUrl,{filter:function(e,o){return e.properties.categoria===r&&!0===e.properties.premiado},pointToLayer:pointToLayer}),a=new L.markerClusterGroup;s.on("data:loaded",(function(){a.addLayer(s),map.spin(!1)})),clustersPremiumAndProperties.push({category:r,clusterLayer:a,properties:e})}));const baseLayers=[{id:1,description:"OpenStreetMap",lyr:L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:21,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),active:!0},{id:2,description:"Google Streets",lyr:L.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{maxZoom:21,subdomains:["mt0","mt1","mt2","mt3"],attribution:'&copy; <a href="https://www.google.com/intl/pt-BR/help/terms_maps/">Google</a>'}),active:!1},{id:3,description:"Google Satélite",lyr:L.tileLayer("http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{maxZoom:21,subdomains:["mt0","mt1","mt2","mt3"],attribution:'&copy; <a href="https://www.google.com/intl/pt-BR/help/terms_maps/">Google</a>'}),active:!1}],overlayLayers=[{id:0,description:clustersAndProperties[0].category,lyr:clustersAndProperties[0].clusterLayer,iconClass:clustersAndProperties[0].properties.iconClass,markerColor:clustersAndProperties[0].properties.markerColor,active:!0},{id:1,description:clustersAndProperties[1].category,lyr:clustersAndProperties[1].clusterLayer,iconClass:clustersAndProperties[1].properties.iconClass,markerColor:clustersAndProperties[1].properties.markerColor,active:!0},{id:2,description:clustersAndProperties[2].category,lyr:clustersAndProperties[2].clusterLayer,iconClass:clustersAndProperties[2].properties.iconClass,markerColor:clustersAndProperties[2].properties.markerColor,active:!0},{id:3,description:clustersAndProperties[3].category,lyr:clustersAndProperties[3].clusterLayer,iconClass:clustersAndProperties[3].properties.iconClass,markerColor:clustersAndProperties[3].properties.markerColor,active:!0},{id:4,description:clustersAndProperties[4].category,lyr:clustersAndProperties[4].clusterLayer,iconClass:clustersAndProperties[4].properties.iconClass,markerColor:clustersAndProperties[4].properties.markerColor,active:!0},{id:5,description:clustersAndProperties[5].category,lyr:clustersAndProperties[5].clusterLayer,iconClass:clustersAndProperties[5].properties.iconClass,markerColor:clustersAndProperties[5].properties.markerColor,active:!0},{id:6,description:clustersAndProperties[6].category,lyr:clustersAndProperties[6].clusterLayer,iconClass:clustersAndProperties[6].properties.iconClass,markerColor:clustersAndProperties[6].properties.markerColor,active:!0}],premiumOverlayLayers=[{id:0,description:clustersPremiumAndProperties[0].category,lyr:clustersPremiumAndProperties[0].clusterLayer,iconClass:clustersPremiumAndProperties[0].properties.iconClass,markerColor:clustersPremiumAndProperties[0].properties.markerColor,active:!0},{id:1,description:clustersPremiumAndProperties[1].category,lyr:clustersPremiumAndProperties[1].clusterLayer,iconClass:clustersPremiumAndProperties[1].properties.iconClass,markerColor:clustersPremiumAndProperties[1].properties.markerColor,active:!0},{id:2,description:clustersPremiumAndProperties[2].category,lyr:clustersPremiumAndProperties[2].clusterLayer,iconClass:clustersPremiumAndProperties[2].properties.iconClass,markerColor:clustersPremiumAndProperties[2].properties.markerColor,active:!0},{id:3,description:clustersPremiumAndProperties[3].category,lyr:clustersPremiumAndProperties[3].clusterLayer,iconClass:clustersPremiumAndProperties[3].properties.iconClass,markerColor:clustersPremiumAndProperties[3].properties.markerColor,active:!0},{id:4,description:clustersPremiumAndProperties[4].category,lyr:clustersPremiumAndProperties[4].clusterLayer,iconClass:clustersPremiumAndProperties[4].properties.iconClass,markerColor:clustersPremiumAndProperties[4].properties.markerColor,active:!0},{id:5,description:clustersPremiumAndProperties[5].category,lyr:clustersPremiumAndProperties[5].clusterLayer,iconClass:clustersPremiumAndProperties[5].properties.iconClass,markerColor:clustersPremiumAndProperties[5].properties.markerColor,active:!0},{id:6,description:clustersPremiumAndProperties[6].category,lyr:clustersPremiumAndProperties[6].clusterLayer,iconClass:clustersPremiumAndProperties[6].properties.iconClass,markerColor:clustersPremiumAndProperties[6].properties.markerColor,active:!0}];var caravanasUrl=$("#caravanas_geojson").val(),redMarker=L.AwesomeMarkers.icon({prefix:"fa",icon:"fa-van-shuttle",markerColor:"purple"});const caravanasLayer=new L.GeoJSON.AJAX(caravanasUrl,{pointToLayer:function(r,e){let o=new Date(r.properties.data).toLocaleString("pt-BR",{year:"numeric",month:"numeric",day:"numeric",timeZone:"America/Sao_Paulo"}),s=L.marker(e,{icon:redMarker}),a=`<span>Território Periférico:</span>${r.properties.territorio_periferico}\n                              <span>Caravana:</span>${r.properties.caravana}\n                              <span>Data:</span>${o}\n                            `;return s.bindPopup(a),s}}),caravanasCluster=new L.markerClusterGroup;caravanasLayer.on("data:loaded",(function(){caravanasCluster.addLayer(caravanasLayer),map.spin(!1)}));const caravanasArr=[{id:1,description:"Caravana das Periferias",lyr:caravanasCluster,iconClass:"fa fa-van-shuttle",markerColor:"purple",active:!0}];